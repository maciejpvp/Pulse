type Album {
  id: ID!
  name: String!
  artist: ArtistPreview!
  imageUrl: String
  isBookmarked: Boolean!
  songs(first: Int = 10, after: String): SongConnection!
}

type AlbumPreview {
  id: ID!
  name: String!
  artist: ArtistPreview!
  imageUrl: String
}

input AlbumQueryInput {
  albumId: String!
  artistId: String!
}

type AlbumEdge {
  node: AlbumPreview!
  cursor: String!
}

type AlbumConnection {
  edges: [AlbumEdge!]!
  pageInfo: PageInfo!
}

type CreateAlbumResponse {
  album: Album!
  imageUrl: String!
  fields: String!
}

# Remove Album

input RemoveAlbumInput {
  albumId: String!
  artistId: String!
}

type Artist {
  id: ID!
  name: String!
  songs(first: Int = 10, after: String): SongConnection!
  albums(first: Int = 10, after: String): AlbumConnection!
  imageUrl: String
  isBookmarked: Boolean!
}

type ArtistPreview {
  id: ID!
  name: String!
  imageUrl: String
}

type CreateArtistResponse {
  artist: Artist!
  imageUrl: String!
  fields: String!
}
union BookmarkItem = AlbumPreview | SongPreview | ArtistPreview | PlaylistPreview

type BookmarkConnection {
    edges: [BookmarkEdge!]
    pageInfo: PageInfo!
}

type BookmarkEdge {
    cursor: String!
    node: BookmarkItem!
}

type BookmarkResponse {
    bookmarks: BookmarkConnection!
}

input BookmarkInput {
    limit: Int
    after: String
}

input BookmarkItemInput {
    itemId: ID!
    artistId: ID 
    itemType: ContextType!
}

input BookmarkAddInput {
    items: [BookmarkItemInput!]
}

input BookmarkRemoveInput {
    items: [String!]
}

input CloudStateUpdateInput {
    version: Int
    attributes: CloudStateAttributes!
}

input CloudStateAttributes {
    primeDeviceId: String
    trackId: String
    isPlaying: Boolean
    positionMs: Int
    repeatMode: String
    shuffleMode: String
    volume: Int
}

type CloudState {
    primeDeviceId: String
    trackId: String
    isPlaying: Boolean
    positionMs: Int
    repeatMode: String
    shuffleMode: String
    volume: Int
}

input DevicePingInput {
    deviceId: String!
    name: String!
    type: String!
}

type Device @aws_iam @aws_cognito_user_pools {
    deviceId: String!
    name: String!
    type: String!
}
enum ContextType {
  ALBUM
  PLAYLIST
  ARTIST
  SONG
}

union RecentPlayedItem = AlbumPreview | SongPreview | ArtistPreview | PlaylistPreview


type PageInfo {
  endCursor: String
  hasNextPage: Boolean!
}
enum PlaylistVisibility {
  PUBLIC
  PRIVATE
}

type Playlist {
  id: ID!
  name: String!
  creator: User!
  createdAt: String!
  visibility: PlaylistVisibility!
  songs(first: Int = 10, after: String): SongConnection!
  imageUrl: String
  isBookmarked: Boolean!
}

type PlaylistPreview {
  id: ID!
  name: String!
  imageUrl: String
}

type CreatePlaylistResponse {
  playlist: Playlist!
  imageUrl: String!
  fields: String!
}

input SongInput {
  id: ID!
  artistId: ID!
}

input PlaylistAddSongInput {
  playlistId: ID!
  songs: [SongInput!]
}

input PlaylistRemoveSongInput {
  playlistId: ID!
  songsIds: [ID!]
}

type PlaylistAddSongResult {
  playlistId: ID!
  songsIds: [ID!]
}

type PlaylistRemoveSongResult {
  playlistId: ID!
  songsIds: [ID!]
}

type Query {
  artist(artistId: ID!): Artist!

  album(input: AlbumQueryInput!): Album!

  playlist(playlistId: ID!): Playlist!

  song(songId: ID!, artistId: ID!): Song!

  recentPlayed: [RecentPlayedItem!]!

  bookmarks: BookmarkConnection!

  search(input: SearchInput!): SearchResponse

  cloudState: CloudState!

  devices: [Device!]!

}

type Mutation {
  """
  Get S3 upload URL to upload mp3 file into bucket
  """
  songPlay(input: SongPlayInput!): String!
  songRemove(input: RemoveSongInput!): Boolean!
  songUpload(input: SongUploadInput!): SongUploadResponse!

  artistCreate(name: String!): CreateArtistResponse!
  artistRemove(id: ID!): Boolean!

  albumCreate(name: String!, artistId: ID!): CreateAlbumResponse!
  albumRemove(input: RemoveAlbumInput!): Boolean!
  
  playlistCreate(name: String!): CreatePlaylistResponse!
  playlistAddSong(input: PlaylistAddSongInput!): PlaylistAddSongResult!
  playlistRemoveSong(input: PlaylistRemoveSongInput): PlaylistRemoveSongResult!

  cloudStateUpdate(input: CloudStateUpdateInput!): Boolean!
  devicePing(input: DevicePingInput!): Boolean!
  _publishDevicePing(input: DevicePingInput!): Device
    @aws_iam

  bookmarkAdd(input: BookmarkAddInput!): Boolean!
  bookmarkRemove(input: BookmarkRemoveInput!): Boolean!
}

type Subscription {
  onDevicePing: Device
    @aws_subscribe(mutations: ["_publishDevicePing"])
    @aws_cognito_user_pools
    @aws_iam
}

input SearchInput {
    query: String!
    type: String!
}

type SearchResponse {
    items: [BookmarkItem!]!
}
type Song {
  id: ID!
  title: String!
  artist: ArtistPreview!
  duration: Int
  imageUrl: String
}

type SongPreview {
  id: ID!
  title: String!
  artistId: ID!
  imageUrl: String
}

input SongPlayInput {
  artistId: String!
  songId: String!
  contextType: ContextType!
  contextId: String!
}

input SongUploadInput {
  songTitle: String!
  artistId: ID!
  duration: Int!
  albumId: ID
}

type SongEdge {
  node: Song!
  cursor: String!
}

type SongConnection {
  edges: [SongEdge!]!
  pageInfo: PageInfo!
}

type SongUploadResponse {
  uploadUrl: String!
}

# Remove Songs
input RemoveSongInput {
    songId: ID!
    artistId: ID!
}

    
type User {
  id: ID!
}
